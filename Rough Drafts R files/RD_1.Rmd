---
title: "project101"
output: html_document
date: "2022-12-04"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ezids)
library(ggplot2)
library(dplyr)
library(corrplot)
library(caret)
```

## SMART QUESTION

### Does the age at which adolescents start engaging in "deviant" behaviors predict their interpersonal, physical, and mental well-being? Furthermore, how does race influence interpersonal, physical, and mental well-being?


```{r cars}
dataset = read.csv("/Users/carriemagee/Downloads/DATA6101-FINAL-PROJECT/Datasets/sadc_df.csv")
# select variables v1, v2, v3
myvars <- c("Age_Alc", "Age_Weed","multiple_partners","physical_activity","Hrs_Sleep","age_sex","race","gender","fight","suicide")
data <- dataset[myvars]
data <- data[data$age_sex != 0,]
```


```{r}
data$fight <- recode(data$fight, '0' = 1, '1' = 0)
data$suicide <- recode(data$suicide, '0' = 1, '1' = 0)

```

## Including Plots

```{r}
summary(data)

data$gender <- as.factor(data$gender)
data$race <- as.factor(data$race)

data$suicide1 <- as.factor(data$suicide)
data$fight1 <- as.factor(data$fight)

str(data)
```


You can also embed plots, for example:



```{r}

set.seed(927)
sample <- sample(c(TRUE, FALSE), nrow(data), replace=TRUE, prob=c(0.8,0.2))
traindata1  <- data[sample, ]
testdata1   <- data[!sample, ]


mod1a<-glm(formula = fight1 ~ Age_Weed + Age_Alc + age_sex + race , family = "binomial", data = traindata1)

summary(mod1a)

plot(mod1a)


testdata1$modelPredicted1a <- predict(mod1a, newdata = testdata1, type = 'response')
testdata1 <- testdata1  %>% mutate(model_pred1a = 1*(modelPredicted1a > .55) + 0)

testdata1 <- testdata1 %>% mutate(accurate1a = 1*(model_pred1a == fight1))
Model1aAccuracyPercentage <- (sum(testdata1$accurate1)/nrow(testdata1))*100
Model1aAccuracyPercentage


confMat1 <- table(testdata1$fight1, testdata1$modelPredicted1 > 0.55)
confMat1
```
Here 0 in confusion matrix means the responding teen won't have a fight and 1 means that they are gonna have a fight.

```{r}
set.seed(997)
sample <- sample(c(TRUE, FALSE), nrow(data), replace=TRUE, prob=c(0.8,0.2))
traindata2  <- data[sample, ]
testdata2   <- data[!sample, ]

mod2a<-glm(formula = suicide1 ~ Age_Weed + Age_Alc + age_sex + race , family = "binomial", data = traindata2)

summary(mod2a)
plot(mod2a)



testdata2$modelPredicted2a <- predict(mod2a, newdata = testdata2, type = 'response')
testdata2 <- testdata2  %>% mutate(model_pred2a = 1*(modelPredicted2a > .55) + 0)

testdata2 <- testdata2 %>% mutate(accurate2a = 1*(model_pred2a == suicide1))
Model2aAccuracyPercentage <- (sum(testdata2$accurate2)/nrow(testdata2))*100
Model2aAccuracyPercentage


confMat2 <- table(testdata2$suicide1, testdata2$modelPredicted2a > 0.55)
confMat2


```

```{r}

set.seed(997)
sample <- sample(c(TRUE, FALSE), nrow(data), replace=TRUE, prob=c(0.8,0.2))
traindata3  <- data[sample, ]
testdata3   <- data[!sample, ]


model3a <- lm(Hrs_Sleep ~  Age_Alc + Age_Weed + age_sex + race, data=traindata3)
summary(model3a)
xkabledply(model3a, title = paste("Model :", format(formula(model3a)) ) )
xkablevif(model3a)


testdata3$modelPredicted3a <- predict(model3a, newdata = testdata3)
testdata3


```

```{r}
set.seed(997)
sample <- sample(c(TRUE, FALSE), nrow(data), replace=TRUE, prob=c(0.8,0.2))
traindata4  <- data[sample, ]
testdata4   <- data[!sample, ]


model4a <- lm(multiple_partners ~  Age_Alc + Age_Weed + age_sex + race, data=traindata4)
summary(model4a)
xkabledply(model4a, title = paste("Model :", format(formula(model4a)) ) )
xkablevif(model4a)


testdata4$modelPredicted4a <- predict(model4a, newdata = testdata4)
testdata4
```

```{r}
set.seed(997)
sample <- sample(c(TRUE, FALSE), nrow(data), replace=TRUE, prob=c(0.8,0.2))
traindata5  <- data[sample, ]
testdata5   <- data[!sample, ]


model5a <- lm(physical_activity ~  Age_Alc + Age_Weed + age_sex + race, data=traindata5)
summary(model5a)
xkabledply(model5a, title = paste("Model :", format(formula(model5a)) ) )
xkablevif(model5a)


testdata5$modelPredicted5a <- predict(model5a, newdata = testdata5)
testdata5
```